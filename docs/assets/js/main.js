"use strict";const loading=document.querySelector(".js_loading"),charactersList=document.querySelector(".js_characters"),btn=document.querySelector(".js_btn"),textInput=document.querySelector(".js_textinput"),charactersFavList=document.querySelector(".js_fav");let charactersData=[],charactersSearch=[],charactersFavData=[];function renderCharacters(e){const t=document.createElement("li"),a=document.createElement("article"),r=document.createElement("img"),c=document.createElement("h3"),n=document.createElement("p"),s=document.createTextNode(e.name),d=document.createTextNode(e.occupation);r.setAttribute("src",e.img),r.setAttribute("alt",""+e.name),t.setAttribute("id",""+e.char_id),c.appendChild(s),n.appendChild(d),a.appendChild(r),a.appendChild(c),a.appendChild(n),t.appendChild(a),a.classList.add("article-character"),t.classList.add("js_character"),r.classList.add("img");return t}function addCharactersListerers(){const e=document.querySelectorAll(".js_character");for(const t of e)t.addEventListener("click",handleClickCharacter)}function renderCharactersList(e){loading.innerHTML="";for(const t of e)charactersList.appendChild(renderCharacters(t));addCharactersListerers()}const characterListStored=JSON.parse(localStorage.getItem("characterList"));function renderFilteredList(e){charactersList.innerHTML="";for(const t of e)charactersList.appendChild(renderCharacters(t));addCharactersListerers()}function charactersSearched(){const e=textInput.value.toLowerCase();fetch("https://breakingbadapi.com/api/characters?name="+e).then(e=>e.json()).then(e=>{charactersSearch=e,renderFilteredList(charactersSearch)}).catch(e=>{console.error(e)})}function handleClick(e){e.preventDefault(),charactersSearched()}function selectFav(e){e.currentTarget.classList.toggle("fav")}function addFav(e){const t=charactersData.find(t=>t.char_id===parseInt(e.currentTarget.id)),a=charactersFavData.findIndex(t=>t.char_id===parseInt(e.currentTarget.id));-1===a?charactersFavData.push(t):charactersFavData.splice(a,1),renderFav()}function renderFav(){charactersFavList.innerHTML="";for(const e of charactersFavData)charactersFavList.appendChild(renderCharacters(e));addCharactersListerers()}function handleClickCharacter(){selectFav(event),addFav(event)}null!==characterListStored?(charactersData=characterListStored,renderCharactersList(charactersData)):fetch("https://breakingbadapi.com/api/characters").then(e=>e.json()).then(e=>{charactersData=e,localStorage.setItem("characterList",JSON.stringify(charactersData)),renderCharactersList(charactersData)}).catch(e=>{console.error(e)}),btn.addEventListener("click",handleClick);