"use strict";const loading=document.querySelector(".js_loading"),charactersList=document.querySelector(".js_characters"),charactersFavList=document.querySelector(".js_fav"),textInput=document.querySelector(".js_textinput"),btn=document.querySelector(".js_btn");let charactersData=[],charactersSearch=[],charactersFavData=[];function renderCharacters(e){let a="";a=-1===charactersFavData.findIndex(a=>a.char_id===e.char_id)?"none":"fav";const t=document.createElement("li"),r=document.createElement("article"),c=document.createElement("img"),s=document.createElement("h3"),n=document.createElement("p"),i=document.createTextNode(e.name),d=document.createTextNode(e.occupation);c.setAttribute("src",e.img),c.setAttribute("alt",""+e.name),t.setAttribute("id",""+e.char_id),s.appendChild(i),n.appendChild(d),r.appendChild(c),r.appendChild(s),r.appendChild(n),t.appendChild(r),r.classList.add("article-character"),t.classList.add("li-character"),t.classList.add("js_character"),c.classList.add("img"),t.classList.add(a);return t}function addCharactersListerers(){const e=document.querySelectorAll(".js_character");for(const a of e)a.addEventListener("click",handleClickCharacter)}function renderCharactersList(e){loading.innerHTML="",charactersList.innerHTML="";for(const a of e)charactersList.appendChild(renderCharacters(a));addCharactersListerers()}const characterListStored=JSON.parse(localStorage.getItem("characterList")),favListStored=JSON.parse(localStorage.getItem("favList"));function renderFilteredList(e){charactersList.innerHTML="";for(const a of e)charactersList.appendChild(renderCharacters(a));addCharactersListerers()}function charactersSearched(){const e=textInput.value.toLowerCase();fetch("https://breakingbadapi.com/api/characters?name="+e).then(e=>e.json()).then(e=>{charactersSearch=e,renderFilteredList(charactersSearch)}).catch(e=>{console.error(e)})}function handleClick(e){e.preventDefault(),charactersSearched()}function selectFav(e){e.currentTarget.classList.remove("none"),e.currentTarget.classList.toggle("fav")}function addFav(e){const a=charactersData.find(a=>a.char_id===parseInt(e.currentTarget.id)),t=charactersFavData.findIndex(a=>a.char_id===parseInt(e.currentTarget.id));-1===t?(charactersFavData.push(a),localStorage.setItem("favList",JSON.stringify(charactersFavData))):(charactersFavData.splice(t,1),localStorage.setItem("favList",JSON.stringify(charactersFavData))),renderFav()}function renderFav(){charactersFavList.innerHTML="";for(const e of charactersFavData)charactersFavList.appendChild(renderCharacters(e))}function handleClickCharacter(){selectFav(event),addFav(event)}function handleEnter(e){13===e.keyCode&&(e.preventDefault(),charactersSearched())}null!==favListStored&&(charactersFavData=favListStored,renderFav()),null!==characterListStored?(charactersData=characterListStored,renderCharactersList(charactersData)):fetch("https://breakingbadapi.com/api/characters").then(e=>e.json()).then(e=>{charactersData=e,localStorage.setItem("characterList",JSON.stringify(charactersData)),renderCharactersList(charactersData)}).catch(e=>{console.error(e)}),btn.addEventListener("click",handleClick),textInput.addEventListener("keypress",handleEnter);